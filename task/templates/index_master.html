{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/ico" />


    <title>Panel | CRUD</title>

    <!-- Bootstrap -->
    <link href="{% static 'FrWork/admin_lte/vendors/bootstrap/dist/css/bootstrap.min.css' %}" rel="stylesheet">
    <!-- Font Awesome -->

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="{% static 'FrWork/admin_lte/vendors/nprogress/nprogress.css' %}" rel="stylesheet">
    <!-- iCheck -->
    <link href="{% static 'FrWork/admin_lte/vendors/iCheck/skins/flat/green.css' %}" rel="stylesheet">
	
    <!-- bootstrap-progressbar -->
    <link href="{% static 'FrWork/admin_lte/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css' %}" rel="stylesheet">
    <!-- JQVMap -->
    <link href="{% static 'FrWork/admin_lte/vendors/jqvmap/dist/jqvmap.min.css' %}" rel="stylesheet"/>
    <!-- bootstrap-daterangepicker -->
    <link href="{% static 'FrWork/admin_lte/vendors/bootstrap-daterangepicker/daterangepicker.css' %}" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="{% static 'FrWork/admin_lte/build/css/custom.min.css' %}" rel="stylesheet">
  </head>

  <body class="nav-md">
    <div class="container body">
      <div class="main_container">
        <div class="col-md-3 left_col menu_fixed">
          <div class="left_col scroll-view">
            <div class="navbar nav_title" style="border: 0;">
              <a href="/" class="site_title"><i class="fa-solid fa-globe"></i></i> <span>Sales system</span></a>
            </div>

            <div class="clearfix"></div>

            <!-- menu profile quick info -->

            <!-- /menu profile quick info -->

            <br />

            <!-- sidebar menu -->
            <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
              <div class="menu_section">
                <h3>General</h3>
                <ul class="nav side-menu">
                  <li><a href="/"><i class="fa-solid fa-house fa-xl"></i> Home </a>

                  </li>
                  <li><a><i class="fa-solid fa-cart-shopping fa-xl"></i> Ventas <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="/venta_contado">Vender al contado</a></li>
                      <li><a href="/venta_credito">Vender al credito</a></li>
                      <li><a href="/pendiente_pago">Realizar pago</a></li>
                      
                    </ul>
                  </li>
                  <li><a><i class="fa-solid fa-box fa-xl"></i>  </i> Productos <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="/AgregarProducto">Agregar Producto</a></li>
                      <li><a href="/productos">Productos</a></li>
                    </ul>
                  </li>
                  <li><a><i class="fa-solid fa-keyboard fa-xl"></i> Elementos <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="/marcas/agregar">Marcas</a></li>
                      <li><a href="/colores/agregar">Colores</a></li>
                      <li><a href="icons.html">Categorias</a></li>
                    </ul>
                  </li>
                  <li><a><i class="fa fa-table"></i> Reportes <span class="fa fa-chevron-down fa-xl"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="/listar">Reporte de Ventas</a></li>
                      <li><a href="/pagos">reporte de pagos</a></li>
                    </ul>
                  </li>

                </ul>
              </div>


            </div>
            <!-- /sidebar menu -->

            <!-- /menu footer buttons -->
            <div class="sidebar-footer hidden-small">
              <a data-toggle="tooltip" data-placement="top" title="Settings" >
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Lock">
                <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Logout" href="/signin">
                <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
              </a>
            </div>
            <!-- /menu footer buttons -->
          </div>
        </div>

        <!-- top navigation -->
<div class="top_nav">
  <div class="nav_menu">
    <div class="nav toggle">
      <a id="menu_toggle"><i class="fa fa-bars"></i></a>
    </div>
    <nav class="nav navbar-nav">
      <ul class="navbar-right">
        <li class="nav-item dropdown open" style="padding-left: 15px;">
          <a href="javascript:;" class="user-profile dropdown-toggle" aria-haspopup="true" id="navbarDropdown" data-toggle="dropdown" aria-expanded="false">
            <i class="fa-solid fa-user"></i> Tu Perfil
          </a>
          <div class="dropdown-menu dropdown-usermenu pull-right" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="javascript:;">Perfil</a>
            <a class="dropdown-item" href="/signup">
              <span>Nuevo usuario</span>
            </a>
            <a class="dropdown-item" href="{% url 'logout' %}"><i class="fa fa-sign-out pull-right"></i> Log Out</a>
          </div>
        </li>

        <!-- Notificaciones -->
        <li role="presentation" class="nav-item dropdown open">
          <a href="javascript:;" class="dropdown-toggle info-number" id="navbarDropdown1" data-toggle="dropdown" aria-expanded="false">
            <i class="fa-solid fa-bell"></i>
            <span class="badge bg-green">0</span> <!-- Conteo dinámico de notificaciones -->
          </a>
          <ul class="dropdown-menu list-unstyled msg_list" role="menu" aria-labelledby="navbarDropdown1">
            <!-- Contenido dinámico de notificaciones -->
            <!-- Las notificaciones serán insertadas aquí por el script -->
            <li class="nav-item text-center">
              <a href="/alertas">
                <strong>Ver todas las notificaciones</strong>
                <i class="fa fa-angle-right"></i>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</div>



        <!-- ****************************************   -->

        {% block content %}

        
        {% endblock %}


        <!-- footer content -->
        <footer>
          <div class="pull-right">
            Guatemala - Chiquimula by Team Rainbow Rocks <a href="https://colorlib.com">Colorlib</a>
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>

    <!-- jQuery -->
    <script src="{% static 'FrWork/admin_lte/vendors/jquery/dist/jquery.min.js' %}"></script>
    <!-- Bootstrap -->
    <script src="{% static 'FrWork/admin_lte/vendors/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
    <!-- FastClick -->
    <script src="{% static 'FrWork/admin_lte/vendors/fastclick/lib/fastclick.js' %}"></script>
    <!-- NProgress -->
    <script src="{% static 'FrWork/admin_lte/vendors/nprogress/nprogress.js' %}"></script>
    <!-- Chart.js -->
    <script src="{% static 'FrWork/admin_lte/vendors/Chart.js/dist/Chart.min.js' %}"></script>
    <!-- gauge.js -->
    <script src="{% static 'FrWork/admin_lte/vendors/gauge.js/dist/gauge.min.js' %}"></script>
    <!-- bootstrap-progressbar -->
    <script src="{% static 'FrWork/admin_lte/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js' %}"></script>
    <!-- iCheck -->
    <script src="{% static 'FrWork/admin_lte/vendors/iCheck/icheck.min.js' %}"></script>
    <!-- Skycons -->
    <script src="{% static 'FrWork/admin_lte/vendors/skycons/skycons.js' %}"></script>
    <!-- Flot -->
    <script src="{% static 'FrWork/admin_lte/vendors/Flot/jquery.flot.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/Flot/jquery.flot.pie.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/Flot/jquery.flot.time.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/Flot/jquery.flot.stack.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/Flot/jquery.flot.resize.js' %}"></script>
    <!-- Flot plugins -->
    <script src="{% static 'FrWork/admin_lte/vendors/flot.orderbars/js/jquery.flot.orderBars.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/flot-spline/js/jquery.flot.spline.min.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/flot.curvedlines/curvedLines.js' %}"></script>
    <!-- DateJS -->
    <script src="{% static 'FrWork/admin_lte/vendors/DateJS/build/date.js' %}"></script>
    <!-- JQVMap -->
    <script src="{% static 'FrWork/admin_lte/vendors/jqvmap/dist/jquery.vmap.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/jqvmap/dist/maps/jquery.vmap.world.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js' %}"></script>
    <!-- bootstrap-daterangepicker -->
    <script src="{% static 'FrWork/admin_lte/vendors/moment/min/moment.min.js' %}"></script>
    <script src="{% static 'FrWork/admin_lte/vendors/bootstrap-daterangepicker/daterangepicker.js' %}"></script>

    <!-- Custom Theme Scripts -->
    <script src="{% static 'FrWork/admin_lte/build/js/custom.min.js' %}"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        function cargarNotificaciones() {
          fetch('/obtener_notificaciones/')
            .then(response => response.json())
            .then(data => {
              let notificationsMenu = document.querySelector('.msg_list');
              notificationsMenu.innerHTML = '';  // Limpia las notificaciones anteriores
    
              data.notificaciones.forEach(notification => {
                let li = document.createElement('li');
                li.classList.add('nav-item');
                let badgeClass = notification.tipo === 'urgente' ? 'badge bg-red' : 'badge bg-yellow';
    
                li.innerHTML = `
                  <a class="dropdown-item">
                    <span class="badge ${badgeClass}">${notification.tipo.toUpperCase()}</span>
                    <span class="message">${notification.mensaje}</span>
                  </a>
                `;
    
                notificationsMenu.appendChild(li);
              });
    
              // Actualiza el número total de notificaciones
              let notificationCount = document.querySelector('.info-number .badge');
              notificationCount.textContent = data.total_notificaciones;
    
              // Agrega enlace para ver todas las notificaciones si hay más
              if (data.hay_mas) {
                let verMasLi = document.createElement('li');
                verMasLi.classList.add('nav-item');
                verMasLi.innerHTML = `
                  <div class="text-center">
                    <a href="/alertas">
                      <strong>Ver todas las notificaciones</strong>
                      <i class="fa fa-angle-right"></i>
                    </a>
                  </div>
                `;
                notificationsMenu.appendChild(verMasLi);
              }
            })
            .catch(error => console.error('Error fetching notifications:', error));
        }
    
        // Cargar notificaciones al cargar la página
        cargarNotificaciones();
      });
    </script>

 
  </body>
</html>

